with user_id_max_count_message AS (
SELECT 
	from_user_id 
from 
	messages                                            
where 
	to_user_id =1 
    and  from_user_id  IN (SELECT friend_id from  friendship WHERE user_id =1) 
group by from_user_id   
order by  count(1) desc 
limit 1)
select 
	id, last_name, first_name 
from 
	users 
where  
	id in ( select from_user_id  from user_id_max_count_message) ;
